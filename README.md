# Sionna RT ç„¡ç·šé›»æ¨¡æ“¬ç³»çµ±

ä¸€å€‹åŸºæ–¼ [Sionna](https://nvlabs.github.io/sionna/) çš„ç„¡ç·šé›»å‚³æ’­æ¨¡æ“¬ç³»çµ±ï¼Œæ”¯æ´å¤šå ´æ™¯ RT (Ray Tracing) æ¨¡æ“¬ã€è¨­å‚™ç®¡ç†å’Œè¦–è¦ºåŒ–åˆ†æã€‚

## ğŸ“‹ ç›®éŒ„

-   [åŠŸèƒ½ç‰¹è‰²](#åŠŸèƒ½ç‰¹è‰²)
-   [ç³»çµ±æ¶æ§‹](#ç³»çµ±æ¶æ§‹)
-   [æŠ€è¡“å †ç–Š](#æŠ€è¡“å †ç–Š)
-   [ç’°å¢ƒéœ€æ±‚](#ç’°å¢ƒéœ€æ±‚)
-   [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
-   [é–‹ç™¼æŒ‡å—](#é–‹ç™¼æŒ‡å—)
-   [API æ–‡æª”](#api-æ–‡æª”)
-   [å ´æ™¯ç®¡ç†](#å ´æ™¯ç®¡ç†)
-   [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
-   [è²¢ç»æŒ‡å—](#è²¢ç»æŒ‡å—)

## ğŸš€ åŠŸèƒ½ç‰¹è‰²

### æ ¸å¿ƒåŠŸèƒ½

-   **å¤šå ´æ™¯æ”¯æ´**: æ”¯æ´ NYCUï¼ˆé™½æ˜äº¤é€šå¤§å­¸ï¼‰ã€Lotusï¼ˆè·èŠ±æ± ï¼‰ã€NTPUï¼ˆè‡ºåŒ—å¤§å­¸ï¼‰ã€Nanliaoï¼ˆå—å¯®æ¼æ¸¯ï¼‰
-   **è¨­å‚™ç®¡ç†**: æ”¯æ´åŸºç«™ (Desired)ã€æ¥æ”¶å™¨ (Receiver)ã€å¹²æ“¾å™¨ (Jammer) ä¸‰ç¨®è¨­å‚™é¡å‹
-   **å³æ™‚æ¨¡æ“¬**: åŸºæ–¼ Sionna RT çš„ç„¡ç·šé›»å‚³æ’­æ¨¡æ“¬
-   **2D/3D è¦–è¦ºåŒ–**: æä¾›å¹³é¢å’Œç«‹é«”å ´æ™¯è¦–åœ–

### æ¨¡æ“¬åŠŸèƒ½

-   **SINR åœ°åœ–**: ä¿¡å™ªå¹²æ“¾æ¯”åˆ†å¸ƒè¦–è¦ºåŒ–
-   **CFR åœ–**: é€šé“é »ç‡éŸ¿æ‡‰åˆ†æ
-   **å»¶é²å¤šæ™®å‹’åœ–**: æ™‚å»¶-å¤šæ™®å‹’é »ç§»åˆ†æ
-   **é€šé“éŸ¿æ‡‰åœ–**: 3D é€šé“éŸ¿æ‡‰å¯è¦–åŒ–

### ä½¿ç”¨è€…ä»‹é¢

-   **æ‹–æ‹½å¼è¨­å‚™é…ç½®**: ç›´è§€çš„è¨­å‚™ä½ç½®èª¿æ•´
-   **å³æ™‚é è¦½**: è¨­å‚™è®Šæ›´å³æ™‚åæ˜ åœ¨æ¨¡æ“¬ä¸­
-   **éŸ¿æ‡‰å¼è¨­è¨ˆ**: æ”¯æ´å¤šç¨®è¢å¹•å°ºå¯¸

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚    Backend      â”‚    â”‚   Database      â”‚
â”‚   (React)       â”‚â—„â”€â”€â–ºâ”‚   (FastAPI)     â”‚â—„â”€â”€â–ºâ”‚  (PostgreSQL)   â”‚
â”‚   Port: 5174    â”‚    â”‚   Port: 8889    â”‚    â”‚   Port: 5433    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                        â”‚                        â”‚
        â”‚                        â”‚                        â”‚
        â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vite Dev      â”‚    â”‚ Sionna RT       â”‚    â”‚   PostGIS       â”‚
â”‚   Hot Reload    â”‚    â”‚ æ¨¡æ“¬å¼•æ“        â”‚    â”‚   åœ°ç†æ“´å±•      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’» æŠ€è¡“å †ç–Š

### å‰ç«¯

-   **æ¡†æ¶**: React 19 + TypeScript
-   **å»ºæ§‹å·¥å…·**: Vite 6
-   **3D æ¸²æŸ“**: Three.js + React Three Fiber
-   **æ¨£å¼**: SASS/SCSS
-   **è·¯ç”±**: React Router DOM 6
-   **HTTP å®¢æˆ¶ç«¯**: Axios

### å¾Œç«¯

-   **æ¡†æ¶**: FastAPI (Python)
-   **ORM**: SQLAlchemy + SQLModel
-   **è³‡æ–™åº«é©…å‹•**: asyncpg
-   **æ¨¡æ“¬å¼•æ“**: Sionna + Sionna-RT
-   **3D æ¸²æŸ“**: PyRender + Trimesh
-   **åœ–åƒè™•ç†**: Matplotlib + Pillow

### è³‡æ–™åº«

-   **ä¸»è³‡æ–™åº«**: PostgreSQL 16
-   **åœ°ç†æ“´å±•**: PostGIS 3.4

### éƒ¨ç½²

-   **å®¹å™¨åŒ–**: Docker + Docker Compose
-   **åå‘ä»£ç†**: Vite é–‹ç™¼ä»£ç†
-   **ç¶²è·¯**: Docker è‡ªå®šç¾©ç¶²è·¯

## ğŸ“‹ ç’°å¢ƒéœ€æ±‚

### ç³»çµ±éœ€æ±‚

-   **ä½œæ¥­ç³»çµ±**: Linux (æ¨è–¦ Ubuntu 20.04+)
-   **è¨˜æ†¶é«”**: æœ€å°‘ 8GB RAM (æ¨è–¦ 16GB+)
-   **ç¡¬ç¢Ÿ**: æœ€å°‘ 10GB å¯ç”¨ç©ºé–“
-   **é¡¯ç¤ºå¡**: æ”¯æ´ OpenGL 3.3+ (æ¨è–¦ NVIDIA GPU)

### è»Ÿé«”éœ€æ±‚

-   **Docker**: 20.10+
-   **Docker Compose**: 2.0+
-   **Make**: GNU Make 4.0+ (å¯é¸)

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å…‹éš†å°ˆæ¡ˆ

```bash
git clone <repository-url>
cd web-sionna
```

### 2. ç’°å¢ƒé…ç½®

å‰µå»º `.env` æ–‡ä»¶ï¼š

```bash
# è³‡æ–™åº«é…ç½®
POSTGRES_USER=sionna_user
POSTGRES_PASSWORD=sionna_password
POSTGRES_DB=sionna_db
POSTGRES_PORT=5433

# æ‡‰ç”¨é…ç½®
BACKEND_PORT=8889
FRONTEND_PORT=5174
```

### 3. å¿«é€Ÿå•Ÿå‹•

```bash
# ä½¿ç”¨ Makeï¼ˆæ¨è–¦ï¼‰
make up

# æˆ–ä½¿ç”¨ Docker Compose
docker compose up -d
```

### 4. è¨ªå•æ‡‰ç”¨

-   **å‰ç«¯**: http://localhost:5174
-   **å¾Œç«¯ API**: http://localhost:8889
-   **API æ–‡æª”**: http://localhost:8889/docs

### 5. é©—è­‰å®‰è£

```bash
# æª¢æŸ¥æœå‹™ç‹€æ…‹
make status

# æŸ¥çœ‹æ—¥èªŒ
make logs
```

## ğŸ› ï¸ é–‹ç™¼æŒ‡å—

### é–‹ç™¼ç’°å¢ƒå•Ÿå‹•

```bash
# å•Ÿå‹•æ‰€æœ‰æœå‹™
make dev

# å–®ç¨é‡å•Ÿå¾Œç«¯
make restart-backend

# å–®ç¨é‡å•Ÿå‰ç«¯
make restart-frontend
```

### ç¨‹å¼ç¢¼é–‹ç™¼

```bash
# é€²å…¥å¾Œç«¯å®¹å™¨
make shell-backend

# é€²å…¥å‰ç«¯å®¹å™¨
make shell-frontend

# é€²å…¥è³‡æ–™åº«
make shell-db
```

### æ¸¬è©¦èˆ‡å“è³ªæª¢æŸ¥

```bash
# åŸ·è¡Œå‰ç«¯ linting
make lint-frontend

# åŸ·è¡Œå¾Œç«¯æ¸¬è©¦
make test-backend

# å»ºæ§‹ç”Ÿç”¢ç‰ˆæœ¬
make build-prod
```

### è³‡æ–™åº«ç®¡ç†

```bash
# é‡ç½®è³‡æ–™åº«
make db-reset

# å‚™ä»½è³‡æ–™åº«
make db-backup

# é‚„åŸè³‡æ–™åº«
make db-restore
```

## ğŸ“š API æ–‡æª”

### æ ¸å¿ƒç«¯é»

#### è¨­å‚™ç®¡ç†

-   `GET /api/v1/devices/` - ç²å–æ‰€æœ‰è¨­å‚™
-   `POST /api/v1/devices/` - å‰µå»ºæ–°è¨­å‚™
-   `PUT /api/v1/devices/{id}` - æ›´æ–°è¨­å‚™
-   `DELETE /api/v1/devices/{id}` - åˆªé™¤è¨­å‚™

#### æ¨¡æ“¬åŠŸèƒ½

-   `GET /api/v1/simulations/scene-image` - ç²å–å ´æ™¯åœ–åƒ
-   `GET /api/v1/simulations/sinr-map` - ç”Ÿæˆ SINR åœ°åœ–
-   `GET /api/v1/simulations/cfr-plot` - ç”Ÿæˆ CFR åœ–
-   `GET /api/v1/simulations/doppler-plots` - ç”Ÿæˆå»¶é²å¤šæ™®å‹’åœ–
-   `GET /api/v1/simulations/channel-response` - ç”Ÿæˆé€šé“éŸ¿æ‡‰åœ–

#### å ´æ™¯ç®¡ç†

-   `GET /api/v1/simulations/scenes` - ç²å–å¯ç”¨å ´æ™¯åˆ—è¡¨
-   `GET /api/v1/simulations/scene/{name}` - ç²å–å ´æ™¯è³‡è¨Š
-   `GET /api/v1/sionna/models/{model}` - ç²å– 3D æ¨¡å‹

### API æ¸¬è©¦

```bash
# ç²å–è¨­å‚™åˆ—è¡¨
curl http://localhost:8889/api/v1/devices/

# ç”Ÿæˆ SINR åœ°åœ–
curl "http://localhost:8889/api/v1/simulations/sinr-map?scene=nycu"

# æª¢æŸ¥ API å¥åº·ç‹€æ…‹
curl http://localhost:8889/ping
```

## ğŸ¢ å ´æ™¯ç®¡ç†

### æ”¯æ´å ´æ™¯

| å ´æ™¯ä»£ç¢¼  | é¡¯ç¤ºåç¨±     | æè¿°         |
| --------- | ------------ | ------------ |
| `nycu`    | é™½æ˜äº¤é€šå¤§å­¸ | å¤§å­¸æ ¡åœ’ç’°å¢ƒ |
| `lotus`   | è·èŠ±æ±        | è‡ªç„¶ç’°å¢ƒå ´æ™¯ |
| `ntpu`    | è‡ºåŒ—å¤§å­¸     | éƒ½å¸‚æ ¡åœ’ç’°å¢ƒ |
| `nanliao` | å—å¯®æ¼æ¸¯     | æµ·å²¸ç’°å¢ƒå ´æ™¯ |

### å ´æ™¯æª”æ¡ˆçµæ§‹

```
backend/app/static/scene/{SCENE_NAME}/
â”œâ”€â”€ {SCENE_NAME}.glb          # 3D æ¨¡å‹æª”æ¡ˆ
â”œâ”€â”€ {SCENE_NAME}.xml          # Sionna å ´æ™¯é…ç½®
â”œâ”€â”€ textures/                 # ç´‹ç†æª”æ¡ˆç›®éŒ„
â”‚   â””â”€â”€ EXPORT_GOOGLE_SAT_WM.png
â””â”€â”€ meshes/                   # ç¶²æ ¼æª”æ¡ˆç›®éŒ„
```

### æ–°å¢å ´æ™¯

1. åœ¨ `backend/app/static/scene/` ç›®éŒ„ä¸‹å‰µå»ºå ´æ™¯è³‡æ–™å¤¾
2. æ·»åŠ å°æ‡‰çš„ GLB æ¨¡å‹å’Œ XML é…ç½®æª”æ¡ˆ
3. æ›´æ–° `frontend/src/utils/sceneUtils.ts` ä¸­çš„å ´æ™¯æ˜ å°„
4. é‡æ–°å•Ÿå‹•æœå‹™

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. æœå‹™å•Ÿå‹•å¤±æ•—

```bash
# æª¢æŸ¥ Docker ç‹€æ…‹
docker --version
docker compose --version

# æª¢æŸ¥ç«¯å£å ç”¨
sudo netstat -tlpn | grep -E "(5174|8889|5433)"

# æ¸…ç†ä¸¦é‡æ–°å•Ÿå‹•
make clean
make up
```

#### 2. è³‡æ–™åº«é€£æ¥å•é¡Œ

```bash
# æª¢æŸ¥è³‡æ–™åº«ç‹€æ…‹
make db-status

# é‡ç½®è³‡æ–™åº«
make db-reset

# æŸ¥çœ‹è³‡æ–™åº«æ—¥èªŒ
docker compose logs postgis
```

#### 3. å‰ç«¯ç†±é‡è¼‰å•é¡Œ

```bash
# é‡å•Ÿå‰ç«¯æœå‹™
make restart-frontend

# æª¢æŸ¥ Vite é…ç½®
docker compose logs frontend
```

#### 4. GPU æ¸²æŸ“å•é¡Œ

```bash
# æª¢æŸ¥ OpenGL æ”¯æ´
docker compose exec backend python -c "import pyrender; print('PyRender OK')"

# æª¢æŸ¥ CUDA å¯ç”¨æ€§
docker compose exec backend python -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"
```

### æ—¥èªŒæª¢æŸ¥

```bash
# æŸ¥çœ‹æ‰€æœ‰æœå‹™æ—¥èªŒ
make logs

# æŸ¥çœ‹ç‰¹å®šæœå‹™æ—¥èªŒ
make logs-backend
make logs-frontend
make logs-db

# è·Ÿè¹¤å³æ™‚æ—¥èªŒ
make logs-follow
```

### æ•ˆèƒ½å„ªåŒ–

```bash
# æ¸…ç†æœªä½¿ç”¨çš„ Docker è³‡æº
make docker-clean

# é‡å»ºå®¹å™¨æ˜ åƒ
make rebuild

# æª¢æŸ¥ç³»çµ±è³‡æºä½¿ç”¨
make system-info
```

## ğŸ”§ Make æŒ‡ä»¤åƒè€ƒ

æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æŒ‡ä»¤ï¼š

```bash
make help
```

ä¸»è¦æŒ‡ä»¤ï¼š

-   `make up` - å•Ÿå‹•æ‰€æœ‰æœå‹™
-   `make down` - åœæ­¢æ‰€æœ‰æœå‹™
-   `make restart` - é‡å•Ÿæ‰€æœ‰æœå‹™
-   `make clean` - æ¸…ç†æ‰€æœ‰è³‡æº
-   `make logs` - æŸ¥çœ‹æœå‹™æ—¥èªŒ
-   `make shell-backend` - é€²å…¥å¾Œç«¯å®¹å™¨
-   `make db-reset` - é‡ç½®è³‡æ–™åº«

æ›´å¤šè©³ç´°æŒ‡ä»¤è«‹åƒè€ƒ [Makefile](Makefile)ã€‚
